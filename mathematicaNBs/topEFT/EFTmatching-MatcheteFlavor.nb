(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     44673,       1250]
NotebookOptionsPosition[     41165,       1184]
NotebookOutlinePosition[     41659,       1202]
CellTagsIndexPosition[     41616,       1199]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Load Matchete", "Section",
 CellChangeTimes->{{3.950967822810131*^9, 
  3.950967831955306*^9}},ExpressionUUID->"63e7d9bf-906f-4794-a583-\
b0f0b0d2ba8e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Needs", "[", "\"\<Matchete`\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.9509655433473883`*^9, 3.9509655483709707`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"4444d9d7-624e-4e8c-bbcd-da2de5e439a2"],

Cell[BoxData[
 TemplateBox[{
   TemplateBox[{7}, "Spacer1"], 
   StyleBox[
    GraphicsBox[{
      Thickness[0.001364256480218281], 
      StyleBox[{
        FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 
          3}}, {{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 
          0}}, {{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 0}, {0, 1, 0}, {0, 
          1, 0}}, {{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}}, {{
          0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 0}, {0, 1, 0}, {0, 1, 
          0}}, {{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 0}, {0, 1, 0}, {0, 
          1, 0}}, {{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 0}, {0, 1, 0}, {
          0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0,
           1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 
          1, 0}}, {{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 0}, {1, 3, 3}, {
          1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1,
           3, 3}, {0, 1, 0}}, {{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0,
           1, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0,
           1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 0}, {0, 1, 0}, {0,
           1, 0}}, {{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0,
           1, 0}, {0, 1, 0}}}, {{{72.93, 83.}, {26.633000000000003`, 
          82.977}, {-1.742, 81.805}, {0.082, 78.641}, {-0.188, 66.973}, {
          44.672000000000004`, 5.977000000000004}, {95.309, 
          2.4569999999999936`}, {223.895, -4.878999999999991}, {400.984, 
          15.824000000000012`}, {574.0619999999999, 22.507999999999996`}, {
          574.0619999999999, 74.629}, {426.60900000000004`, 75.59}, {
          191.24599999999998`, 83.055}, {72.93, 83.}}, {{79.766, 72.844}, {
          97.039, 72.844}, {107.301, 63.022999999999996`}, {
          119.85199999999999`, 72.844}, {138.23399999999998`, 72.844}, {
          134.766, 60.441}, {76.293, 60.441}}, {{162.82000000000002`, 
          72.844}, {181.42200000000003`, 72.844}, {184.08200000000002`, 
          60.441}, {152.18800000000002`, 60.441}}, {{204.531, 72.844}, {
          249.26999999999998`, 72.844}, {245.875, 60.586}, {
          196.70299999999997`, 60.586}}, {{266.84000000000003`, 72.844}, {
          300.801, 72.844}, {297.184, 60.441}, {252.961, 60.441}, {253.895, 
          63.59}, {255.617, 66.371}, {258.129, 68.781}, {260.93399999999997`, 
          71.488}, {263.83599999999996`, 72.844}, {266.84000000000003`, 
          72.844}}, {{307.96099999999996`, 72.844}, {325.754, 72.844}, {
          322.42999999999995`, 60.441}, {304.71099999999996`, 60.441}}, {{
          339.043, 72.844}, {356.83599999999996`, 72.844}, {
          353.58599999999996`, 60.441}, {335.57, 60.441}}, {{
          366.43399999999997`, 72.844}, {409.84000000000003`, 72.844}, {
          406.594, 60.441}, {358.457, 60.441}}, {{420.324, 72.844}, {465.062, 
          72.844}, {461.668, 60.586}, {412.5, 60.586}}, {{473.47999999999996`,
           72.844}, {516.891, 72.844}, {513.641, 60.441}, {465.508, 
          60.441}}, {{148.277, 55.715}, {185.11299999999997`, 55.715}, {
          192.35200000000003`, 21.976999999999997`}, {173.82000000000002`, 
          21.976999999999997`}, {168.797, 42.055}, {158.316, 42.055}, {
          143.477, 21.976999999999997`}, {105.67999999999999`, 
          21.976999999999997`}, {114.09400000000001`, 52.242000000000004`}, {
          101.617, 42.129000000000005`}, {91.281, 52.242000000000004`}, {
          82.71900000000001, 21.976999999999997`}, {65.664, 
          21.976999999999997`}, {75.039, 55.641}, {133.58200000000002`, 
          55.641}, {125.312, 26.401999999999994`}}, {{213.465, 55.641}, {
          230.148, 55.641}, {221.21499999999997`, 21.976999999999997`}, {
          204.309, 21.976999999999997`}}, CompressedData["
1:eJxTTMoPSmViYGAQBWIQLRuVYn3/boGDadwuT55L3g6djglPL3QUOGz7/PdK
xUpnh/J986X0uwscUq3v+/eGOzsobijKmNhb4HD4q0ZMP5OzA6/uprnv+wsc
Lijd/lm3yskhFmgM0/QCB82Y/kNfLZwg6pcWONhyXV9c8NbRQaj5wKmFu6Hm
HXd0mCzBEsanWgTng+WfFzq0id089/2yKcT+wgI4/yLInnv5cH7r68Adcpb5
Dhog+zIsHEDW2H7Kg8hPtnU47m3e6Xgnz0EA5E51e4j6q3kOlS/VDDnWODgs
cgX6FCj/qy5rT4mwk8PWE2X75t/Lc5hzRGFDUYSTwzeQwQ/zHLx4mLTbrzlB
/PksD+LuXmcHoC3BjwvzIepPeDsAAGmFoGg=
          "], {{303.01599999999996`, 55.641}, {352.10900000000004`, 55.641}, {
          342.953, 21.901999999999994`}, {325.09, 21.901999999999994`}, {
          330.402, 42.276999999999994`}, {317.484, 42.276999999999994`}, {
          311.801, 21.976999999999997`}, {293.71099999999996`, 
          21.976999999999997`}}, {{361.484, 55.641}, {405.043, 55.641}, {
          401.5, 42.202999999999996`}, {377.504, 42.202999999999996`}, {
          375.58599999999996`, 35.266}, {399.35900000000004`, 35.266}, {
          395.812, 21.976999999999997`}, {352.477, 21.976999999999997`}}, {{
          429.258, 55.641}, {445.941, 55.641}, {437.008, 
          21.976999999999997`}, {420.105, 21.976999999999997`}}, {{
          468.53099999999995`, 55.641}, {512.09, 55.641}, {508.547, 
          42.202999999999996`}, {484.555, 42.202999999999996`}, {482.633, 
          35.266}, {506.40599999999995`, 35.266}, {502.863, 
          21.976999999999997`}, {459.527, 21.976999999999997`}}}], 
        FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
          3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}, {{0, 2, 0}, {1, 3, 3}, {1, 3, 
          3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}}, {{1, 4, 3}, {0, 1, 0}, {1, 3, 
          3}}, {{0, 2, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}}}, {CompressedData["
1:eJxTTMoPSmViYGAQB2IQnTnxbY19WJuDtP5dFTbFYAfdTXPfL+dpc7DccqJs
n3ywQ9aekskS81odtn3+e6VCMthhmnN3znPlVgeQsmPCwQ5RKdb3/c+3Oixy
Bar4YumQATLvbquDC1DZ75OmDp8u+SYJPGmF6Ltt4uBj3umY8LbVgQEEHIwd
gLp7p/9udQCqXvlRyNBBrvV14I5JbQ4vLijd/nnP0MGO6/rigq1tEPM0TR0O
f9WI6d/b5mABNOapgZkDiLrwtM2hd3qeULOBj0PFvvlS+o/aHIpBDnEPdBCI
APoEyAfbFxAE4V9rg7ozCOK/bVD9EsEO8iD7gfaB/SMT7PB46ewjCiuh5gHD
A+xeoPtCwBLBDsBQ8DZvboOEDzD8wObnIfjo4QsARrGtpA==
          "], {{579.16, 76.383}, {579.16, 20.5}, {579.0740000000001, 
          16.801000000000002`}, {594.875, 18.64800000000001}, {597.453, 
          20.5}, {600.195, 21.851999999999997`}, {601.328, 25.914}, {
          603.4689999999999, 26.016000000000005`}, {608.6840000000001, 
          25.617000000000004`}, {613.9730000000001, 25.311999999999998`}, {
          619.348, 25.077999999999996`}, {597.5980000000001, 76.191}, {591.02,
           76.234}, {584.707, 76.289}, {579.16, 76.383}}, {{672.4219999999999,
           76.289}, {661.8119999999999, 76.227}, {650.4730000000001, 76.18}, {
          639.125, 76.148}, {661.02, 24.699000000000005`}, {671.3159999999999,
           24.891}, {682.164, 25.246000000000002`}, {693.914, 25.781}}, {{
          601.6880000000001, 76.168}, {623.496, 24.909999999999997`}, {
          634.102, 24.531}, {645.141, 24.445}, {656.977, 
          24.617000000000004`}, {635.055, 76.137}, {623.535, 76.109}, {
          612.219, 76.117}, {601.6880000000001, 76.168}}}]}, {
        FaceForm[
         RGBColor[0., 0.31764699999999996`, 0.5921569999999999, 1.]]}, 
       StripOnInput -> False]}, ImageSize -> {733., 83.}, 
     PlotRange -> {{0., 733.}, {0., 83.}}, AspectRatio -> Automatic], 
    Magnification -> 0.5, StripOnInput -> False], 
   TemplateBox[{
     InterpretationBox[
      Cell[
      "v0.3.0", Bold, FontColor -> RGBColor[0, 0.3168, 0.5928], FontSize -> 
       15, FontFamily -> "Source Code Pro"], 
      TextCell[
      "v0.3.0", Bold, FontColor -> RGBColor[0, 0.3168, 0.5928], FontSize -> 
       15, FontFamily -> "Source Code Pro"]]}, "Row", 
    DisplayFunction -> (PaneBox[#, BaselinePosition -> Scaled[0.5]]& ), 
    InterpretationFunction -> (RowBox[{"Row", "[", 
       RowBox[{
         RowBox[{"{", #, "}"}], ",", 
         RowBox[{"BaselinePosition", "\[Rule]", 
           RowBox[{"Scaled", "[", "0.5`", "]"}]}]}], "]"}]& )]},
  "RowWithSeparator"]],
 CellMargins->{{70, 5}, {5, 5}},
 GeneratedCell->True,
 CellAutoOverwrite->True,
 CellChangeTimes->{
  3.951406815395856*^9},ExpressionUUID->"941f2f02-ab42-4bce-b65d-\
99bcd746258f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"by Javier Fuentes-Mart\[IAcute]n, Matthias K\[ODoubleDot]nig, \
Julie Pag\[EGrave]s, Anders Eller Thomsen, and Felix Wilsch \\n\"\>", 
   "\[InvisibleSpace]", "\<\"Reference: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"\"arXiv:2212.04510\"", "https://arxiv.org/abs/2212.04510"},
    "HyperlinkURL"], "\[InvisibleSpace]", "\<\"\\n\"\>", 
   "\[InvisibleSpace]", "\<\"Website: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{
    "\"https://gitlab.com/matchete/matchete\"", 
     "https://gitlab.com/matchete/matchete"},
    "HyperlinkURL"]}],
  SequenceForm[
  "by Javier Fuentes-Mart\[IAcute]n, Matthias K\[ODoubleDot]nig, Julie Pag\
\[EGrave]s, Anders Eller Thomsen, and Felix Wilsch \n", "Reference: ", 
   Hyperlink["arXiv:2212.04510", "https://arxiv.org/abs/2212.04510"], "\n", 
   "Website: ", 
   Hyperlink[
   "https://gitlab.com/matchete/matchete", 
    "https://gitlab.com/matchete/matchete"]],
  Editable->False]], "Print",
 CellChangeTimes->{3.951405115124461*^9, 3.951405714847858*^9, 
  3.951406075741563*^9, 3.951406660454615*^9, 3.951406707119811*^9, 
  3.951406815586298*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"a2a37a36-bae8-4650-8023-2f22324ca3d2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Load BSM model", "Section",
 CellChangeTimes->{{3.845613648725794*^9, 3.845613650913772*^9}, {
  3.84622482168526*^9, 3.8462248226073103`*^9}, {3.878148939224256*^9, 
  3.878148940715598*^9}, {3.950966758208434*^9, 3.950966760900529*^9}, {
  3.951203010803582*^9, 3.9512030127075768`*^9}, {3.951405611969962*^9, 
  3.951405613313587*^9}},ExpressionUUID->"3b2e93b4-e5ae-4774-93e6-\
ef7268cde36a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Get", "[", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], ",", 
     "\"\<TopBSM_model.wl\>\""}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"LBSM", "//", "NiceForm"}]}], "Input",
 CellChangeTimes->{{3.951405615280346*^9, 3.951405672127771*^9}, {
  3.951406218275732*^9, 3.951406228476939*^9}, {3.9514063753212843`*^9, 
  3.9514063764447403`*^9}, {3.9514066558600683`*^9, 3.951406661155637*^9}, {
  3.951406808580497*^9, 3.951406808815764*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"e126bc8e-2085-4eb3-b9c1-34e7d2c4855c"],

Cell[BoxData[
 FormBox[
  StyleBox[
   RowBox[{
    RowBox[{
     TemplateBox[{
       SubscriptBox["D", "\[Mu]"], 
       SubsuperscriptBox[
        OverscriptBox["\!\(\*SubscriptBox[\(\[Phi]\), \(T\)]\)", 
         StyleBox["_", FontWeight -> Bold]], 
        StyleBox["a", FontSize -> 10], 
        StyleBox["p", FontSize -> 10]]},
      "RowDefault"], 
     TemplateBox[{
       SubscriptBox["D", "\[Mu]"], 
       SuperscriptBox["\!\(\*SubscriptBox[\(\[Phi]\), \(T\)]\)", 
        StyleBox[
         TemplateBox[{"a", "p"}, "RowDefault"], FontSize -> 10]]},
      "RowDefault"]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       SuperscriptBox[
        SubscriptBox["M", "\[Phi]"], 
        StyleBox["p",
         FontSize->10]], ")"}], "2"], 
     SubsuperscriptBox[
      OverscriptBox[
       SubscriptBox["\[Phi]", "T"], 
       StyleBox["_",
        FontWeight->Bold]], 
      StyleBox["a",
       FontSize->10], 
      StyleBox["p",
       FontSize->10]], 
     SuperscriptBox[
      SubscriptBox["\[Phi]", "T"], 
      StyleBox[
       TemplateBox[{"a", "p"},
        "RowDefault"],
       FontSize->10]]}], "+", 
    RowBox[{"\[ImaginaryI]", 
     FormBox[
      StyleBox[
       RowBox[{"(", 
        RowBox[{
         OverscriptBox["\[Chi]", 
          StyleBox["_",
           FontWeight->Bold]], "\[CenterDot]", 
         SubscriptBox["\[Gamma]", 
          StyleBox["\[Mu]",
           FontSize->10]], "\[CenterDot]", 
         TemplateBox[{
           SubscriptBox["D", "\[Mu]"], "\[Chi]"},
          "RowDefault"]}], ")"}],
       SpanSymmetric->False],
      StandardForm]}], "-", 
    RowBox[{
     SubscriptBox["M", "\[Chi]"], 
     FormBox[
      StyleBox[
       RowBox[{"(", 
        OverscriptBox["\[Chi]", 
         StyleBox["_",
          FontWeight->Bold]], "\[CenterDot]", "\[Chi]", ")"}],
       SpanSymmetric->False],
      StandardForm]}], "-", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["y", "DM"], 
      StyleBox[
       TemplateBox[{"p", "r"},
        "RowDefault"],
       FontSize->10]], 
     SubsuperscriptBox[
      OverscriptBox[
       SubscriptBox["\[Phi]", "T"], 
       StyleBox["_",
        FontWeight->Bold]], 
      StyleBox["a",
       FontSize->10], 
      StyleBox["r",
       FontSize->10]], 
     FormBox[
      StyleBox[
       RowBox[{"(", 
        OverscriptBox["\[Chi]", 
         StyleBox["_",
          FontWeight->Bold]], "\[CenterDot]", 
        SubscriptBox["P", "R"], "\[CenterDot]", 
        SuperscriptBox["u", 
         StyleBox[
          TemplateBox[{"a", "p"},
           "RowDefault"],
          FontSize->10]], ")"}],
       SpanSymmetric->False],
      StandardForm]}], "-", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["y", "DM"], 
      StyleBox[
       TemplateBox[{"p", "r"},
        "RowDefault"],
       FontSize->10]], 
     SuperscriptBox[
      SubscriptBox["\[Phi]", "T"], 
      StyleBox[
       TemplateBox[{"a", "r"},
        "RowDefault"],
       FontSize->10]], 
     FormBox[
      StyleBox[
       RowBox[{"(", 
        SubsuperscriptBox[
         OverscriptBox["u", 
          StyleBox["_",
           FontWeight->Bold]], 
         StyleBox["a",
          FontSize->10], 
         StyleBox["p",
          FontSize->10]], "\[CenterDot]", 
        SubscriptBox["P", "L"], "\[CenterDot]", "\[Chi]", ")"}],
       SpanSymmetric->False],
      StandardForm]}]}], "StandardForm"], Matchete`NiceForm]], "Output",
 CellChangeTimes->{
  3.951405755961458*^9, 3.951406079148324*^9, {3.951406207190939*^9, 
   3.951406229448769*^9}, {3.951406371046609*^9, 3.951406378150339*^9}, 
   3.9514066641736183`*^9, 3.951406708066902*^9, 3.95140682207996*^9},
 CellLabel->
  "Out[3]//NiceForm=",ExpressionUUID->"e781e7e6-d337-4e8b-8bdd-e4dbb12ccbb1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CheckLagrangian", "[", "LUV", "]"}]], "Input",
 CellLabel->"In[4]:=",ExpressionUUID->"f24f5fb4-5566-4678-a066-1cae5e4912fd"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.9514062330144653`*^9, 3.9514068251055403`*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"3c019ea5-bbd5-4762-8ce8-299553d07a7e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LUV", "//", "NiceForm"}]], "Input",
 CellLabel->"In[5]:=",ExpressionUUID->"75beccbd-845e-4f12-a76f-b833a6e1e971"],

Cell[BoxData[
 FormBox[
  StyleBox[
   RowBox[{
    RowBox[{"-", 
     RowBox[{
      FractionBox["1", "4"], 
      FractionBox["1", 
       SuperscriptBox[
        SubscriptBox["g", "Y"], "2"]], 
      SuperscriptBox[
       SuperscriptBox["B", 
        StyleBox[
         TemplateBox[{"\[Mu]", "\[Nu]"},
          "RowDefault"],
         FontSize->10]], "2"]}]}], "-", 
    RowBox[{
     FractionBox["1", "4"], 
     FractionBox["1", 
      SuperscriptBox[
       SubscriptBox["g", "s"], "2"]], 
     SuperscriptBox[
      SuperscriptBox["G", 
       StyleBox[
        TemplateBox[{"\[Mu]", "\[Nu]", "A"},
         "RowDefault"],
        FontSize->10]], "2"]}], "-", 
    RowBox[{
     FractionBox["1", "4"], 
     FractionBox["1", 
      SuperscriptBox[
       SubscriptBox["g", "L"], "2"]], 
     SuperscriptBox[
      SuperscriptBox["W", 
       StyleBox[
        TemplateBox[{"\[Mu]", "\[Nu]", "I"},
         "RowDefault"],
        FontSize->10]], "2"]}], "+", 
    RowBox[{
     TemplateBox[{
       SubscriptBox["D", "\[Mu]"], 
       SubscriptBox[
        OverscriptBox["H", 
         StyleBox["_", FontWeight -> Bold]], 
        StyleBox["i", FontSize -> 10]]},
      "RowDefault"], 
     TemplateBox[{
       SubscriptBox["D", "\[Mu]"], 
       SuperscriptBox["H", 
        StyleBox["i", FontSize -> 10]]},
      "RowDefault"]}], "+", 
    RowBox[{"\[Mu]2", 
     SubscriptBox[
      OverscriptBox["H", 
       StyleBox["_",
        FontWeight->Bold]], 
      StyleBox["i",
       FontSize->10]], 
     SuperscriptBox["H", 
      StyleBox["i",
       FontSize->10]]}], "+", 
    RowBox[{
     TemplateBox[{
       SubscriptBox["D", "\[Mu]"], 
       SubsuperscriptBox[
        OverscriptBox["\!\(\*SubscriptBox[\(\[Phi]\), \(T\)]\)", 
         StyleBox["_", FontWeight -> Bold]], 
        StyleBox["a", FontSize -> 10], 
        StyleBox["p", FontSize -> 10]]},
      "RowDefault"], 
     TemplateBox[{
       SubscriptBox["D", "\[Mu]"], 
       SuperscriptBox["\!\(\*SubscriptBox[\(\[Phi]\), \(T\)]\)", 
        StyleBox[
         TemplateBox[{"a", "p"}, "RowDefault"], FontSize -> 10]]},
      "RowDefault"]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       SuperscriptBox[
        SubscriptBox["M", "\[Phi]"], 
        StyleBox["p",
         FontSize->10]], ")"}], "2"], 
     SubsuperscriptBox[
      OverscriptBox[
       SubscriptBox["\[Phi]", "T"], 
       StyleBox["_",
        FontWeight->Bold]], 
      StyleBox["a",
       FontSize->10], 
      StyleBox["p",
       FontSize->10]], 
     SuperscriptBox[
      SubscriptBox["\[Phi]", "T"], 
      StyleBox[
       TemplateBox[{"a", "p"},
        "RowDefault"],
       FontSize->10]]}], "+", 
    RowBox[{"\[ImaginaryI]", 
     FormBox[
      StyleBox[
       RowBox[{"(", 
        RowBox[{
         OverscriptBox["\[Chi]", 
          StyleBox["_",
           FontWeight->Bold]], "\[CenterDot]", 
         SubscriptBox["\[Gamma]", 
          StyleBox["\[Mu]",
           FontSize->10]], "\[CenterDot]", 
         TemplateBox[{
           SubscriptBox["D", "\[Mu]"], "\[Chi]"},
          "RowDefault"]}], ")"}],
       SpanSymmetric->False],
      StandardForm]}], "-", 
    RowBox[{
     SubscriptBox["M", "\[Chi]"], 
     FormBox[
      StyleBox[
       RowBox[{"(", 
        OverscriptBox["\[Chi]", 
         StyleBox["_",
          FontWeight->Bold]], "\[CenterDot]", "\[Chi]", ")"}],
       SpanSymmetric->False],
      StandardForm]}], "+", 
    RowBox[{"\[ImaginaryI]", 
     FormBox[
      StyleBox[
       RowBox[{"(", 
        RowBox[{
         SubsuperscriptBox[
          OverscriptBox["d", 
           StyleBox["_",
            FontWeight->Bold]], 
          StyleBox["a",
           FontSize->10], 
          StyleBox["p",
           FontSize->10]], "\[CenterDot]", 
         RowBox[{
          SubscriptBox["\[Gamma]", 
           StyleBox["\[Mu]",
            FontSize->10]], 
          SubscriptBox["P", "R"]}], "\[CenterDot]", 
         TemplateBox[{
           SubscriptBox["D", "\[Mu]"], 
           SuperscriptBox["d", 
            StyleBox[
             TemplateBox[{"a", "p"}, "RowDefault"], FontSize -> 10]]},
          "RowDefault"]}], ")"}],
       SpanSymmetric->False],
      StandardForm]}], "+", 
    RowBox[{"\[ImaginaryI]", 
     FormBox[
      StyleBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          OverscriptBox["e", 
           StyleBox["_",
            FontWeight->Bold]], 
          StyleBox["p",
           FontSize->10]], "\[CenterDot]", 
         RowBox[{
          SubscriptBox["\[Gamma]", 
           StyleBox["\[Mu]",
            FontSize->10]], 
          SubscriptBox["P", "R"]}], "\[CenterDot]", 
         TemplateBox[{
           SubscriptBox["D", "\[Mu]"], 
           SuperscriptBox["e", 
            StyleBox["p", FontSize -> 10]]},
          "RowDefault"]}], ")"}],
       SpanSymmetric->False],
      StandardForm]}], "+", 
    RowBox[{"\[ImaginaryI]", 
     FormBox[
      StyleBox[
       RowBox[{"(", 
        RowBox[{
         SubsuperscriptBox[
          OverscriptBox["l", 
           StyleBox["_",
            FontWeight->Bold]], 
          StyleBox["i",
           FontSize->10], 
          StyleBox["p",
           FontSize->10]], "\[CenterDot]", 
         RowBox[{
          SubscriptBox["\[Gamma]", 
           StyleBox["\[Mu]",
            FontSize->10]], 
          SubscriptBox["P", "L"]}], "\[CenterDot]", 
         TemplateBox[{
           SubscriptBox["D", "\[Mu]"], 
           SuperscriptBox["l", 
            StyleBox[
             TemplateBox[{"i", "p"}, "RowDefault"], FontSize -> 10]]},
          "RowDefault"]}], ")"}],
       SpanSymmetric->False],
      StandardForm]}], "+", 
    RowBox[{"\[ImaginaryI]", 
     FormBox[
      StyleBox[
       RowBox[{"(", 
        RowBox[{
         SubsuperscriptBox[
          OverscriptBox["q", 
           StyleBox["_",
            FontWeight->Bold]], 
          StyleBox[
           TemplateBox[{"a", "i"},
            "RowDefault"],
           FontSize->10], 
          StyleBox["p",
           FontSize->10]], "\[CenterDot]", 
         RowBox[{
          SubscriptBox["\[Gamma]", 
           StyleBox["\[Mu]",
            FontSize->10]], 
          SubscriptBox["P", "L"]}], "\[CenterDot]", 
         TemplateBox[{
           SubscriptBox["D", "\[Mu]"], 
           SuperscriptBox["q", 
            StyleBox[
             TemplateBox[{"a", "i", "p"}, "RowDefault"], FontSize -> 10]]},
          "RowDefault"]}], ")"}],
       SpanSymmetric->False],
      StandardForm]}], "+", 
    RowBox[{"\[ImaginaryI]", 
     FormBox[
      StyleBox[
       RowBox[{"(", 
        RowBox[{
         SubsuperscriptBox[
          OverscriptBox["u", 
           StyleBox["_",
            FontWeight->Bold]], 
          StyleBox["a",
           FontSize->10], 
          StyleBox["p",
           FontSize->10]], "\[CenterDot]", 
         RowBox[{
          SubscriptBox["\[Gamma]", 
           StyleBox["\[Mu]",
            FontSize->10]], 
          SubscriptBox["P", "R"]}], "\[CenterDot]", 
         TemplateBox[{
           SubscriptBox["D", "\[Mu]"], 
           SuperscriptBox["u", 
            StyleBox[
             TemplateBox[{"a", "p"}, "RowDefault"], FontSize -> 10]]},
          "RowDefault"]}], ")"}],
       SpanSymmetric->False],
      StandardForm]}], "-", 
    RowBox[{
     FractionBox["1", "2"], "\[Lambda]", 
     SubscriptBox[
      OverscriptBox["H", 
       StyleBox["_",
        FontWeight->Bold]], 
      StyleBox["i",
       FontSize->10]], 
     SubscriptBox[
      OverscriptBox["H", 
       StyleBox["_",
        FontWeight->Bold]], 
      StyleBox["j",
       FontSize->10]], 
     SuperscriptBox["H", 
      StyleBox["i",
       FontSize->10]], 
     SuperscriptBox["H", 
      StyleBox["j",
       FontSize->10]]}], "-", 
    RowBox[{
     SuperscriptBox[
      OverscriptBox[
       SubscriptBox["Y", "d"], 
       StyleBox["_",
        FontWeight->Bold]], 
      StyleBox[
       TemplateBox[{"p", "r"},
        "RowDefault"],
       FontSize->10]], 
     SubscriptBox[
      OverscriptBox["H", 
       StyleBox["_",
        FontWeight->Bold]], 
      StyleBox["i",
       FontSize->10]], 
     FormBox[
      StyleBox[
       RowBox[{"(", 
        SubsuperscriptBox[
         OverscriptBox["d", 
          StyleBox["_",
           FontWeight->Bold]], 
         StyleBox["a",
          FontSize->10], 
         StyleBox["r",
          FontSize->10]], "\[CenterDot]", 
        SubscriptBox["P", "L"], "\[CenterDot]", 
        SuperscriptBox["q", 
         StyleBox[
          TemplateBox[{"a", "i", "p"},
           "RowDefault"],
          FontSize->10]], ")"}],
       SpanSymmetric->False],
      StandardForm]}], "-", 
    RowBox[{
     SuperscriptBox[
      OverscriptBox[
       SubscriptBox["Y", "e"], 
       StyleBox["_",
        FontWeight->Bold]], 
      StyleBox[
       TemplateBox[{"p", "r"},
        "RowDefault"],
       FontSize->10]], 
     SubscriptBox[
      OverscriptBox["H", 
       StyleBox["_",
        FontWeight->Bold]], 
      StyleBox["i",
       FontSize->10]], 
     FormBox[
      StyleBox[
       RowBox[{"(", 
        SuperscriptBox[
         OverscriptBox["e", 
          StyleBox["_",
           FontWeight->Bold]], 
         StyleBox["r",
          FontSize->10]], "\[CenterDot]", 
        SubscriptBox["P", "L"], "\[CenterDot]", 
        SuperscriptBox["l", 
         StyleBox[
          TemplateBox[{"i", "p"},
           "RowDefault"],
          FontSize->10]], ")"}],
       SpanSymmetric->False],
      StandardForm]}], "-", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["Y", "e"], 
      StyleBox[
       TemplateBox[{"p", "r"},
        "RowDefault"],
       FontSize->10]], 
     SuperscriptBox["H", 
      StyleBox["i",
       FontSize->10]], 
     FormBox[
      StyleBox[
       RowBox[{"(", 
        SubsuperscriptBox[
         OverscriptBox["l", 
          StyleBox["_",
           FontWeight->Bold]], 
         StyleBox["i",
          FontSize->10], 
         StyleBox["p",
          FontSize->10]], "\[CenterDot]", 
        SubscriptBox["P", "R"], "\[CenterDot]", 
        SuperscriptBox["e", 
         StyleBox["r",
          FontSize->10]], ")"}],
       SpanSymmetric->False],
      StandardForm]}], "-", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["Y", "d"], 
      StyleBox[
       TemplateBox[{"p", "r"},
        "RowDefault"],
       FontSize->10]], 
     SuperscriptBox["H", 
      StyleBox["i",
       FontSize->10]], 
     FormBox[
      StyleBox[
       RowBox[{"(", 
        SubsuperscriptBox[
         OverscriptBox["q", 
          StyleBox["_",
           FontWeight->Bold]], 
         StyleBox[
          TemplateBox[{"a", "i"},
           "RowDefault"],
          FontSize->10], 
         StyleBox["p",
          FontSize->10]], "\[CenterDot]", 
        SubscriptBox["P", "R"], "\[CenterDot]", 
        SuperscriptBox["d", 
         StyleBox[
          TemplateBox[{"a", "r"},
           "RowDefault"],
          FontSize->10]], ")"}],
       SpanSymmetric->False],
      StandardForm]}], "-", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["Y", "u"], 
      StyleBox[
       TemplateBox[{"p", "r"},
        "RowDefault"],
       FontSize->10]], 
     SubscriptBox[
      OverscriptBox["H", 
       StyleBox["_",
        FontWeight->Bold]], 
      StyleBox["i",
       FontSize->10]], 
     FormBox[
      StyleBox[
       RowBox[{"(", 
        SubsuperscriptBox[
         OverscriptBox["q", 
          StyleBox["_",
           FontWeight->Bold]], 
         StyleBox[
          TemplateBox[{"a", "j"},
           "RowDefault"],
          FontSize->10], 
         StyleBox["p",
          FontSize->10]], "\[CenterDot]", 
        SubscriptBox["P", "R"], "\[CenterDot]", 
        SuperscriptBox["u", 
         StyleBox[
          TemplateBox[{"a", "r"},
           "RowDefault"],
          FontSize->10]], ")"}],
       SpanSymmetric->False],
      StandardForm], 
     SuperscriptBox["\[CurlyEpsilon]", 
      StyleBox[
       TemplateBox[{"j", "i"},
        "RowDefault"],
       FontSize->10]]}], "-", 
    RowBox[{
     SuperscriptBox[
      OverscriptBox[
       SubscriptBox["Y", "u"], 
       StyleBox["_",
        FontWeight->Bold]], 
      StyleBox[
       TemplateBox[{"p", "r"},
        "RowDefault"],
       FontSize->10]], 
     SuperscriptBox["H", 
      StyleBox["j",
       FontSize->10]], 
     FormBox[
      StyleBox[
       RowBox[{"(", 
        SubsuperscriptBox[
         OverscriptBox["u", 
          StyleBox["_",
           FontWeight->Bold]], 
         StyleBox["a",
          FontSize->10], 
         StyleBox["r",
          FontSize->10]], "\[CenterDot]", 
        SubscriptBox["P", "L"], "\[CenterDot]", 
        SuperscriptBox["q", 
         StyleBox[
          TemplateBox[{"a", "i", "p"},
           "RowDefault"],
          FontSize->10]], ")"}],
       SpanSymmetric->False],
      StandardForm], 
     SubscriptBox[
      OverscriptBox["\[CurlyEpsilon]", 
       StyleBox["_",
        FontWeight->Bold]], 
      StyleBox[
       TemplateBox[{"i", "j"},
        "RowDefault"],
       FontSize->10]]}], "-", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["y", "DM"], 
      StyleBox[
       TemplateBox[{"p", "r"},
        "RowDefault"],
       FontSize->10]], 
     SubsuperscriptBox[
      OverscriptBox[
       SubscriptBox["\[Phi]", "T"], 
       StyleBox["_",
        FontWeight->Bold]], 
      StyleBox["a",
       FontSize->10], 
      StyleBox["r",
       FontSize->10]], 
     FormBox[
      StyleBox[
       RowBox[{"(", 
        OverscriptBox["\[Chi]", 
         StyleBox["_",
          FontWeight->Bold]], "\[CenterDot]", 
        SubscriptBox["P", "R"], "\[CenterDot]", 
        SuperscriptBox["u", 
         StyleBox[
          TemplateBox[{"a", "p"},
           "RowDefault"],
          FontSize->10]], ")"}],
       SpanSymmetric->False],
      StandardForm]}], "-", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["y", "DM"], 
      StyleBox[
       TemplateBox[{"p", "r"},
        "RowDefault"],
       FontSize->10]], 
     SuperscriptBox[
      SubscriptBox["\[Phi]", "T"], 
      StyleBox[
       TemplateBox[{"a", "r"},
        "RowDefault"],
       FontSize->10]], 
     FormBox[
      StyleBox[
       RowBox[{"(", 
        SubsuperscriptBox[
         OverscriptBox["u", 
          StyleBox["_",
           FontWeight->Bold]], 
         StyleBox["a",
          FontSize->10], 
         StyleBox["p",
          FontSize->10]], "\[CenterDot]", 
        SubscriptBox["P", "L"], "\[CenterDot]", "\[Chi]", ")"}],
       SpanSymmetric->False],
      StandardForm]}]}], "StandardForm"], Matchete`NiceForm]], "Output",
 CellChangeTimes->{3.951406235059154*^9, 3.95140682657263*^9},
 CellLabel->
  "Out[5]//NiceForm=",ExpressionUUID->"8fe93fc1-5200-4411-a498-ee8354f32e73"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matching to the effective Lagrangian", "Section",
 CellChangeTimes->{{3.845614760169002*^9, 3.845614763444982*^9}, {
  3.846224914509673*^9, 3.846224929013171*^9}, {3.8781469923629847`*^9, 
  3.878147011614043*^9}, {3.878148954169182*^9, 
  3.878148959049612*^9}},ExpressionUUID->"a49ed43d-a4ab-4a7a-a2e3-\
836bd40d9378"],

Cell[CellGroupData[{

Cell["One-loop", "Subsection",
 CellChangeTimes->{{3.8781470144478493`*^9, 3.87814702599408*^9}, 
   3.8781489995859747`*^9},ExpressionUUID->"99dbeabd-cd8f-4d7c-afc3-\
47158ad974d1"],

Cell[CellGroupData[{

Cell["Matching", "Subsubsection",
 CellChangeTimes->{{3.879340400569256*^9, 
  3.8793404057852697`*^9}},ExpressionUUID->"07151077-eff1-4f1a-849b-\
a3cc294940e6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LEFT0", "=", 
   RowBox[{"EOMSimplify", "[", 
    RowBox[{
     RowBox[{"Match", "[", 
      RowBox[{"LUV", ",", 
       RowBox[{"EFTOrder", "->", "6"}], ",", 
       RowBox[{"LoopOrder", "->", "0"}]}], "]"}], ",", 
     RowBox[{"ReductionIdentities", "->", "dDimensional"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LEFTtree", "=", 
   RowBox[{"GreensSimplify", "[", 
    RowBox[{
     RowBox[{"Expand", "[", "LEFT0", "]"}], ",", " ", 
     RowBox[{"ReductionIdentities", " ", "->", " ", "EvanescenceFree"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9512045255029*^9, 3.9512045878645678`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"3d74cd3c-c40b-4071-978a-ecf0886b726c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LEFT1", "=", " ", 
   RowBox[{"Match", "[", 
    RowBox[{"LUV", ",", 
     RowBox[{"LoopOrder", "\[Rule]", 
      RowBox[{"{", "1", "}"}]}], ",", 
     RowBox[{"EFTOrder", "\[Rule]", "6"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LEFT1", " ", "=", " ", 
   RowBox[{"GreensSimplify", "[", 
    RowBox[{"LEFT1", ",", 
     RowBox[{"ReductionIdentities", "->", "FourDimensional"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LEFToff", "=", 
   RowBox[{"LEFT1", "+", "LEFTtree"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LEFToff", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Matchete`PackageScope`LagrangianExpand", "[", 
      RowBox[{"LEFToff", "/.", 
       RowBox[{"(", 
        RowBox[{"\[ScriptD]", "->", 
         RowBox[{"(", 
          RowBox[{"4", "-", 
           RowBox[{"2", "\[Epsilon]"}]}], ")"}]}], ")"}]}], "]"}], "/.", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Epsilon]", "^", 
        RowBox[{"-", "1"}]}], "->", "0"}], ")"}]}], "/.", 
    RowBox[{"(", 
     RowBox[{"\[Epsilon]", "->", "0"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"LEFToff", "//", "NiceForm"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.845619792301433*^9, 3.84561984828168*^9}, {
   3.845619884625238*^9, 3.8456198852925863`*^9}, {3.845620061412258*^9, 
   3.845620061568886*^9}, {3.8460711749413557`*^9, 3.8460711850818*^9}, {
   3.846139337204265*^9, 3.8461393393053493`*^9}, 3.878142899785668*^9, {
   3.878143646384809*^9, 3.8781436725986843`*^9}, 3.8781471376633987`*^9, {
   3.878149773013378*^9, 3.878149773521523*^9}, {3.879339323865982*^9, 
   3.879339324062503*^9}, 3.879339585285079*^9, {3.879340175368647*^9, 
   3.879340175723711*^9}, {3.879340222693078*^9, 3.879340259647582*^9}, {
   3.8793404869265337`*^9, 3.879340487064809*^9}, 3.896802523154911*^9, {
   3.896802815963232*^9, 3.896802816125392*^9}, {3.8968031052407713`*^9, 
   3.896803105307475*^9}, 3.896840859008354*^9, 3.8968542126185017`*^9, 
   3.8968543681422167`*^9, {3.896855988434361*^9, 3.896855988619658*^9}, {
   3.897201289464836*^9, 3.8972013066927223`*^9}, {3.8983400962128696`*^9, 
   3.8983401763212833`*^9}, {3.8983402079982224`*^9, 3.898340266389699*^9}, 
   3.9509687948990183`*^9, {3.950968864755011*^9, 3.95096888476248*^9}, {
   3.950968927165427*^9, 3.9509689305699453`*^9}, {3.950969054156788*^9, 
   3.950969059801416*^9}, {3.951204477745768*^9, 3.951204488552742*^9}, {
   3.9512046012062063`*^9, 3.951204685736204*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"9b93d35d-f0c9-4810-a623-f5428ddb5814"]
}, Open  ]],

Cell[CellGroupData[{

Cell["On-shell", "Subsubsection",
 CellChangeTimes->{{3.8793404101740103`*^9, 3.879340415649033*^9}, 
   3.879340536806472*^9, {3.9509689432638407`*^9, 
   3.950968944569963*^9}},ExpressionUUID->"ab65a6ea-e8a4-42dc-8168-\
f30b92c22ae2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"LEFTon", "=", 
   RowBox[{"GreensSimplify", "[", 
    RowBox[{
     RowBox[{"EOMSimplify", "[", 
      RowBox[{"LEFToff", ",", 
       RowBox[{"DummyCoefficients", "->", "True"}], ",", 
       RowBox[{"ReductionIdentities", "->", "dDimensional"}]}], "]"}], ",", 
     RowBox[{"ReductionIdentities", "->", "EvanescenceFree"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9509689508961*^9, 3.9509689602901983`*^9}, {
  3.950969014931703*^9, 3.9509690168041477`*^9}, {3.951204711738351*^9, 
  3.951204728682909*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"854fdcd7-a4d7-4dd7-97f5-8827d7bd5006"],

Cell[BoxData[
 InterpretationBox["\<\"Added new CG \\!\\(\\*RowBox[{\\\"cg1\\\"}]\\) with \
indices \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"Bar\\\", \\\"[\\\", \
RowBox[{\\\"SU2L\\\", \\\"[\\\", \\\"fund\\\", \\\"]\\\"}], \\\"]\\\"}], \
\\\",\\\", RowBox[{\\\"SU2L\\\", \\\"[\\\", \\\"adj\\\", \\\"]\\\"}], \\\",\\\
\", RowBox[{\\\"Bar\\\", \\\"[\\\", RowBox[{\\\"SU2L\\\", \\\"[\\\", \\\"fund\
\\\", \\\"]\\\"}], \\\"]\\\"}]}], \\\"}\\\"}]\\)\"\>",
  StringForm["Added new CG `1` with indices `2`", $CellContext`cg1, {
    Matchete`Bar[
     $CellContext`SU2L[Matchete`fund]], 
    $CellContext`SU2L[Matchete`adj], 
    Matchete`Bar[
     $CellContext`SU2L[Matchete`fund]]}],
  Editable->False]], "Echo",
 CellChangeTimes->{
  3.951406851163205*^9},ExpressionUUID->"ab220512-d7ec-47e1-a8e3-\
850f5d5ba321"]
}, Open  ]],

Cell["\<\
Simplify to the Green basis using integration by parts and collect Hermitian \
conjugate terms in + H.c.\
\>", "Text",
 CellChangeTimes->{{3.878147104043478*^9, 3.8781471252223377`*^9}, {
  3.878147204491753*^9, 3.878147214405656*^9}, {3.879340465181781*^9, 
  3.8793404689672117`*^9}, {3.879340589148611*^9, 
  3.879340619596539*^9}},ExpressionUUID->"aa074b99-947e-4e2a-a02a-\
2a3394aa6696"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", 
       "\"\<LEFT_flavor.m\>\""}], "}"}], "]"}], ",", "LEFTon"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.951404587253429*^9, 3.951404603176291*^9}, {
  3.951404708494327*^9, 3.951404720012122*^9}, {3.951404829841069*^9, 
  3.951404836031546*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"abbdd156-56e1-4bf9-8879-aa3980ea81a4"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mapping to Warsaw basis", "Section",ExpressionUUID->"ca9f8a0a-4337-48be-a28e-319e8c7bc481"],

Cell["\<\
In this section the matching results are mapped onto the Warsaw basis,\
\>", "Text",
 CellChangeTimes->{{3.951406921727479*^9, 
  3.951406922519309*^9}},ExpressionUUID->"601a6094-e71f-474b-ade2-\
09ecc846aa59"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LWarsaw", "=", " ", 
   RowBox[{"EOMSimplify", "[", 
    RowBox[{
     RowBox[{"LoadModel", "[", "\"\<SMEFT\>\"", "]"}], ",", 
     RowBox[{"ReductionIdentities", " ", "->", " ", "FourDimensional"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LWarsaw", "=", " ", 
   RowBox[{"LWarsaw", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Coupling", "[", 
       RowBox[{
        RowBox[{"cllHH", "|", "cduu", "|", "cqqq", "|", "cqqu", "|", "cduq"}],
         ",", "___"}], "]"}], "->", "0"}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.951203272337616*^9, 3.9512032725927773`*^9}, {
  3.951203312605906*^9, 3.951203332808988*^9}, {3.951203458468226*^9, 
  3.951203458843347*^9}, {3.951203495863626*^9, 3.9512035139079723`*^9}, {
  3.951204060607497*^9, 3.951204064689685*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"c939f2a9-eeb4-4cab-9adb-8ad1ac6c02aa"],

Cell["Determine the matching conditions in the Warsaw basis.", "Text",ExpressionUUID->"bd1c55b1-ce1b-4564-a1d9-4f6f78051031"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"remove", " ", "all", " ", "poles"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{"LEFTonSimp", " ", "=", " ", 
    RowBox[{"CollectOperators", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"Matchete`PackageScope`BetterExpand", "[", "LEFTon", "]"}], "/.", 
       RowBox[{
        RowBox[{"\[Epsilon]", "^", 
         RowBox[{"-", "1"}]}], "->", "0"}]}], "]"}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.951203361051777*^9, 3.9512033659921503`*^9}, {
  3.9512035886439037`*^9, 3.951203591919479*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"8295a371-d09e-4276-a7c0-6fd0373eb72d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MatchingCondition", "=", " ", 
   RowBox[{"MapEffectiveCouplings", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"ReplaceEffectiveCouplings", "[", "LEFTonSimp", "]"}], ",", "\n",
      "\t\t", 
     RowBox[{"ReplaceEffectiveCouplings", "[", "LWarsaw", "]"}], "\n", "\t\t",
      ",", 
     RowBox[{"AppendEffectiveCouplingsDefs", " ", "->", " ", "True"}], "\n", 
     "\t\t", ",", 
     RowBox[{"EOMSimplify", "                  ", "->", " ", "False"}], "\n", 
     "\t\t", ",", 
     RowBox[{"ReductionIdentities", "          ", "->", " ", "dDimensional"}],
      "\n", "\t\t", ",", 
     RowBox[{"ShiftRenCouplings", "            ", "->", " ", "False"}]}], 
    "\n", "\t", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.951203370581851*^9, 3.9512033898252497`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"a7c72005-2c32-4b59-9ba3-94bef31a9d21"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MatchingConditionSimp", "=", 
   RowBox[{"Simplify", "[", " ", 
    RowBox[{"DeleteCases", "[", 
     RowBox[{"MatchingCondition", ",", 
      RowBox[{"a_", "\[Rule]", " ", "0"}]}], "]"}], "]"}]}], ";"}]], "Input",
 CellLabel->"In[18]:=",ExpressionUUID->"adf68de5-77a2-45d9-ad8f-5b0e0b627e30"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", 
       "\"\<matchingCondition_flavor.m\>\""}], "}"}], "]"}], ",", 
    "MatchingConditionSimp"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.951405069983904*^9, 3.951405093552559*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"a1cc9229-abca-411a-b002-38c33d3324c7"]
}, Open  ]]
},
WindowSize->{1386, 761.25},
WindowMargins->{{-2.25, Automatic}, {Automatic, -22.5}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
FrontEndVersion->"14.1 for Linux x86 (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"d9bfba02-5085-40cf-ab1b-9647126cff88"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 158, 3, 65, "Section",ExpressionUUID->"63e7d9bf-906f-4794-a583-b0f0b0d2ba8e"],
Cell[741, 27, 240, 4, 29, "Input",ExpressionUUID->"4444d9d7-624e-4e8c-bbcd-da2de5e439a2"],
Cell[984, 33, 8124, 129, 51, InheritFromParent,ExpressionUUID->"941f2f02-ab42-4bce-b65d-99bcd746258f"],
Cell[9111, 164, 1243, 26, 60, "Print",ExpressionUUID->"a2a37a36-bae8-4650-8023-2f22324ca3d2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10391, 195, 401, 6, 65, "Section",ExpressionUUID->"3b2e93b4-e5ae-4774-93e6-ef7268cde36a"],
Cell[CellGroupData[{
Cell[10817, 205, 618, 13, 49, "Input",ExpressionUUID->"e126bc8e-2085-4eb3-b9c1-34e7d2c4855c"],
Cell[11438, 220, 3762, 129, 50, "Output",ExpressionUUID->"e781e7e6-d337-4e8b-8bdd-e4dbb12ccbb1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15237, 354, 148, 2, 29, "Input",ExpressionUUID->"f24f5fb4-5566-4678-a066-1cae5e4912fd"],
Cell[15388, 358, 177, 2, 33, "Output",ExpressionUUID->"3c019ea5-bbd5-4762-8ce8-299553d07a7e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15602, 365, 137, 2, 29, "Input",ExpressionUUID->"75beccbd-845e-4f12-a76f-b833a6e1e971"],
Cell[15742, 369, 14775, 537, 124, "Output",ExpressionUUID->"8fe93fc1-5200-4411-a498-ee8354f32e73"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[30566, 912, 327, 5, 65, "Section",ExpressionUUID->"a49ed43d-a4ab-4a7a-a2e3-836bd40d9378"],
Cell[CellGroupData[{
Cell[30918, 921, 182, 3, 53, "Subsection",ExpressionUUID->"99dbeabd-cd8f-4d7c-afc3-47158ad974d1"],
Cell[CellGroupData[{
Cell[31125, 928, 161, 3, 43, "Subsubsection",ExpressionUUID->"07151077-eff1-4f1a-849b-a3cc294940e6"],
Cell[31289, 933, 748, 19, 51, "Input",ExpressionUUID->"3d74cd3c-c40b-4071-978a-ecf0886b726c"],
Cell[32040, 954, 2641, 57, 111, "Input",ExpressionUUID->"9b93d35d-f0c9-4810-a623-f5428ddb5814"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34718, 1016, 236, 4, 43, "Subsubsection",ExpressionUUID->"ab65a6ea-e8a4-42dc-8168-f30b92c22ae2"],
Cell[CellGroupData[{
Cell[34979, 1024, 636, 14, 29, "Input",ExpressionUUID->"854fdcd7-a4d7-4dd7-97f5-8827d7bd5006"],
Cell[35618, 1040, 815, 16, 24, "Echo",ExpressionUUID->"ab220512-d7ec-47e1-a8e3-850f5d5ba321"]
}, Open  ]],
Cell[36448, 1059, 402, 8, 33, "Text",ExpressionUUID->"aa074b99-947e-4e2a-a02a-2a3394aa6696"],
Cell[36853, 1069, 518, 13, 29, "Input",ExpressionUUID->"abbdd156-56e1-4bf9-8879-aa3980ea81a4"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[37432, 1089, 97, 0, 65, "Section",ExpressionUUID->"ca9f8a0a-4337-48be-a28e-319e8c7bc481"],
Cell[37532, 1091, 220, 5, 33, "Text",ExpressionUUID->"601a6094-e71f-474b-ade2-09ecc846aa59"],
Cell[37755, 1098, 926, 21, 51, "Input",ExpressionUUID->"c939f2a9-eeb4-4cab-9adb-8ad1ac6c02aa"],
Cell[38684, 1121, 125, 0, 33, "Text",ExpressionUUID->"bd1c55b1-ce1b-4564-a1d9-4f6f78051031"],
Cell[38812, 1123, 667, 16, 49, "Input",ExpressionUUID->"8295a371-d09e-4276-a7c0-6fd0373eb72d"],
Cell[39482, 1141, 883, 18, 173, "Input",ExpressionUUID->"a7c72005-2c32-4b59-9ba3-94bef31a9d21"],
Cell[40368, 1161, 328, 7, 30, "Input",ExpressionUUID->"adf68de5-77a2-45d9-ad8f-5b0e0b627e30"],
Cell[40699, 1170, 450, 11, 29, "Input",ExpressionUUID->"a1cc9229-abca-411a-b002-38c33d3324c7"]
}, Open  ]]
}
]
*)

