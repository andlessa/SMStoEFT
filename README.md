# SMStoEFT
Repository for holding code and data for the SMS -> EFT project

## Installation

The following Mathematica packages must be installed (in <home folder>/.Mathematica/Applications)[^1]:

  * [FeynArts,FormCalc,LoopTools](https://feynarts.de/)
  * [FeynRules](https://feynrules.irmp.ucl.ac.be/)
  * [FeynCalc](https://feyncalc.github.io/)
  * [FeynHelpers](https://github.com/FeynCalc/feynhelpers)
  * [Package-X](https://gitlab.com/mule-tools/package-x) (use this [tarball](./packageX.tar.gz))

In addition [MadGraph5](https://launchpad.net/mg5amcnlo) with [Collier](https://collier.hepforge.org/) must also be installed.

## Loop Calculation

The [NLOCT](http://inspirehep.net/record/1300359) package can be used to automatically compute the required
counterterms and finite rational terms for a given model. The results can be exported to a UFO model,
which can then be used by MadGraph5. The calculation of all the counterterms for a full BSM model (SM+NP)
is quite heavy and unstable. In most cases only the QCD corrections are included (diagrams with colored particles
in the loop and/or involving alpha_s couplings). In order to include loop diagrams generated by New Physics (NP), the following procedure was applied:

  1. The SM sector was limited to QCD (gluons and quarks)
  2. A BSM model was then defined as QCD+NP
  3. The full calculation of counterterms was performed for this QCD+NP model
  4. In parallel, the QCD counterterms were computed for the full SM
  5. Finally the BSM model was defined as the SM+NP and the counterterms from steps 3. and 4. were merged. As a result the BSM model contain all the counterterms for QCD plus corrections from NP

A notebook implementing all of the above steps can be found [here](./mathematicaNBs/SMS-stop-NLO.nb) and additional checks to make sure the counterterms are compatible were made [here](./mathematicaNBs/SMS-stop-NLO-Checks.nb).

The resulting model ready for NLO calculations can be found [here](./Models/SMS-stopNLO/).

### Additional comments

Some of the diagrams generated using FeynArts are zero due to color conservation (see [this notebook](./mathematicaNBs/diagrams-DMEFT-stop.nb)), hence these are not generated by MG5. Also not all diagrams are displayed by the automatically generated HTML pages (make sure to check the postscript files).




## Form Factors

### Computing Form Factors

The calculation of form factors can be done using FeynArts, FeynCalc and Package-X (through FeynHelpers).
An example of the calculation of the Higgs-Gluon-Gluon form factor can be found [here](./auxFiles/Examples/feyncalc-HGG.nb).

### Creating Models with Form Factors

Instruction for implementing form factors within MadGraph can be found [here](./InstructionsFormFactors.md). 
These instructions are based on:

 * [MadGraph wiki](https://cp3.irmp.ucl.ac.be/projects/madgraph/wiki/FormFactors)
 * [MadGraph Tutorial](./Refs/Hands-onStartToMG.pdf)
 

   

[^1]: Make sure to include the following lines to <home folder>/Mathematica/Kernel/init.m:

     ```
     $Path = Join[
             {ToFileName[$HomeDirectory, ".Mathematica/Applications/LoopTools/x86_64-Linux/bin"],
             ToFileName[$HomeDirectory, ".Mathematica/Applications/FeynRules"],
             ToFileName[$HomeDirectory, ".Mathematica/Applications/FeynArts"],
             ToFileName[$HomeDirectory, ".Mathematica/Applications/X"]
             }, $Path]

     $FeynRulesPath = SetDirectory[FileNameJoin[{$HomeDirectory, ".Mathematica/Applications/FeynRules"}]];                          
     ```     
